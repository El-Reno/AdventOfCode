import sys
from math import dist

DEBUG = False    # for printing certain output

#pathOne = ['R8','U5','L5','D3']
#pathTwo = ['U7','R6','D4','L4']
#pathOne = ['R75','D30','R83','U83','L12','D49','R71','U7','L72']
#pathTwo = ['U62','R66','U55','R34','D71','R55','D58','R83']
#pathOne = ['R98','U47','R26','D63','R33','U87','L62','D20','R33','U53','R51']
#pathTwo = ['U98','R91','D20','R16','D67','R40','U7','R15','U6','R7']
#pathOne = ['U4','R3']
#pathTwo = ['R1','U3','R2','D1','L1','U3','R1','D2','L2']
#pathOne = ['R1009', 'U263', 'L517', 'U449', 'L805', 'D78', 'L798', 'D883', 'L777', 'D562', 'R652', 'D348', 'R999', 'D767', 'L959', 'U493', 'R59', 'D994', 'L225', 'D226', 'R634', 'D200', 'R953', 'U343', 'L388', 'U158', 'R943', 'U544', 'L809', 'D785', 'R618', 'U499', 'L476', 'U600', 'L452', 'D693', 'L696', 'U764', 'L927', 'D346', 'L863', 'D458', 'L789', 'U268', 'R586', 'U884', 'L658', 'D371', 'L910', 'U178', 'R524', 'U169', 'R973', 'D326', 'R483', 'U233', 'R26', 'U807', 'L246', 'D711', 'L641', 'D75', 'R756', 'U365', 'R203', 'D377', 'R624', 'U430', 'L422', 'U367', 'R547', 'U294', 'L916', 'D757', 'R509', 'D332', 'R106', 'D401', 'L181', 'U5', 'L443', 'U197', 'R406', 'D829', 'R878', 'U35', 'L958', 'U31', 'L28', 'D362', 'R188', 'D582', 'R358', 'U750', 'R939', 'D491', 'R929', 'D513', 'L541', 'U418', 'R861', 'D639', 'L917', 'U582', 'R211', 'U725', 'R711', 'D718', 'L673', 'U921', 'L157', 'U83', 'L199', 'U501', 'L66', 'D993', 'L599', 'D947', 'L26', 'U237', 'L981', 'U833', 'L121', 'U25', 'R641', 'D372', 'L757', 'D645', 'R287', 'U390', 'R274', 'U964', 'R288', 'D209', 'R109', 'D364', 'R983', 'U715', 'L315', 'U758', 'R36', 'D500', 'R626', 'U893', 'L840', 'U716', 'L606', 'U831', 'L969', 'D643', 'L300', 'D838', 'R31', 'D751', 'L632', 'D702', 'R468', 'D7', 'L169', 'U149', 'R893', 'D33', 'R816', 'D558', 'R152', 'U489', 'L237', 'U415', 'R434', 'D472', 'L198', 'D874', 'L351', 'U148', 'R761', 'U809', 'R21', 'D25', 'R586', 'D338', 'L568', 'U20', 'L157', 'U221', 'L26', 'U424', 'R261', 'D227', 'L551', 'D754', 'L90', 'U110', 'L791', 'U433', 'R840', 'U323', 'R240', 'U124', 'L723', 'D418', 'R938', 'D173', 'L160', 'U293', 'R773', 'U204', 'R192', 'U958', 'L472', 'D703', 'R556', 'D168', 'L263', 'U574', 'L845', 'D932', 'R165', 'D348', 'R811', 'D834', 'R960', 'U877', 'R935', 'D141', 'R696', 'U748', 'L316', 'U236', 'L796', 'D566', 'R524', 'U449', 'R378', 'U480', 'L79', 'U227', 'R867', 'D185', 'R474', 'D757', 'R366', 'U153', 'R882', 'U252', 'R861', 'U900', 'R28', 'U381', 'L845', 'U642', 'L849', 'U352', 'R134', 'D294', 'R788', 'D406', 'L693', 'D697', 'L433', 'D872', 'R78', 'D364', 'R240', 'U995', 'R48', 'D681', 'R727', 'D825', 'L583', 'U44', 'R743', 'D929', 'L616', 'D262', 'R997', 'D15', 'R575', 'U341', 'R595', 'U889', 'R254', 'U76', 'R962', 'D944', 'R724', 'D261', 'R608', 'U753', 'L389', 'D324', 'L569', 'U308', 'L488', 'D358', 'L695', 'D863', 'L712', 'D978', 'R149', 'D177', 'R92']
#pathTwo = ['L1003', 'D960', 'L10', 'D57', 'R294', 'U538', 'R867', 'D426', 'L524', 'D441', 'R775', 'U308', 'R577', 'D785', 'R495', 'U847', 'R643', 'D895', 'R448', 'U685', 'L253', 'U312', 'L312', 'U753', 'L89', 'U276', 'R799', 'D923', 'L33', 'U595', 'R400', 'U111', 'L664', 'D542', 'R171', 'U709', 'L809', 'D713', 'L483', 'U918', 'L14', 'U854', 'L150', 'D69', 'L158', 'D500', 'L91', 'D800', 'R431', 'D851', 'L798', 'U515', 'L107', 'U413', 'L94', 'U390', 'L17', 'U221', 'L999', 'D546', 'L191', 'U472', 'L568', 'U114', 'L913', 'D743', 'L713', 'D215', 'L569', 'D674', 'L869', 'U549', 'L789', 'U259', 'L330', 'D76', 'R243', 'D592', 'L646', 'U880', 'L363', 'U542', 'L464', 'D955', 'L107', 'U473', 'R818', 'D786', 'R852', 'U968', 'R526', 'D78', 'L275', 'U891', 'R480', 'U991', 'L981', 'D391', 'R83', 'U691', 'R689', 'D230', 'L217', 'D458', 'R10', 'U736', 'L317', 'D145', 'R902', 'D428', 'R344', 'U334', 'R131', 'D739', 'R438', 'D376', 'L652', 'U304', 'L332', 'D452', 'R241', 'D783', 'R82', 'D317', 'R796', 'U323', 'R287', 'D487', 'L302', 'D110', 'R233', 'U631', 'R584', 'U973', 'L878', 'D834', 'L930', 'U472', 'R120', 'U78', 'R806', 'D21', 'L521', 'U988', 'R251', 'D817', 'R44', 'D789', 'R204', 'D669', 'R616', 'D96', 'R624', 'D891', 'L532', 'U154', 'R438', 'U469', 'R785', 'D431', 'R945', 'U649', 'R670', 'D11', 'R840', 'D521', 'L235', 'D69', 'L551', 'D266', 'L454', 'U807', 'L885', 'U590', 'L647', 'U763', 'R449', 'U194', 'R68', 'U809', 'L884', 'U962', 'L476', 'D648', 'L139', 'U96', 'L300', 'U351', 'L456', 'D202', 'R168', 'D698', 'R161', 'U834', 'L273', 'U47', 'L8', 'D157', 'L893', 'D200', 'L454', 'U723', 'R886', 'U92', 'R474', 'U262', 'L190', 'U110', 'L407', 'D723', 'R786', 'D786', 'L572', 'D915', 'L904', 'U744', 'L820', 'D663', 'R205', 'U878', 'R186', 'U247', 'L616', 'D386', 'R582', 'U688', 'L349', 'D399', 'R702', 'U132', 'L276', 'U866', 'R851', 'D633', 'R468', 'D263', 'R678', 'D96', 'L50', 'U946', 'R349', 'D482', 'R487', 'U525', 'R464', 'U977', 'L499', 'D187', 'R546', 'U708', 'L627', 'D470', 'R673', 'D886', 'L375', 'U616', 'L503', 'U38', 'L775', 'D8', 'L982', 'D556', 'R159', 'U680', 'L124', 'U777', 'L640', 'D607', 'R248', 'D671', 'L65', 'D290', 'R445', 'U778', 'L650', 'U679', 'L846', 'D1', 'L769', 'U659', 'R734', 'D962', 'R588', 'U178', 'R888', 'D753', 'R223', 'U318', 'L695', 'D586', 'R430', 'D61', 'R105', 'U801', 'R953', 'U721', 'L856', 'U769', 'R937', 'D335', 'R895']
#pathOne = ['R997', 'U849', 'R349', 'U641', 'R581', 'D39', 'R285', 'U139', 'R455', 'D346', 'L965', 'D707', 'R393', 'D302', 'L263', 'U58', 'R950', 'U731', 'R858', 'D748', 'R302', 'U211', 'R588', 'D441', 'L153', 'D417', 'R861', 'U775', 'R777', 'U204', 'R929', 'U868', 'L62', 'U163', 'R841', 'D214', 'L648', 'U626', 'R501', 'D751', 'L641', 'D961', 'L23', 'D430', 'L73', 'D692', 'R49', 'U334', 'L601', 'U996', 'R444', 'D658', 'R633', 'D30', 'L861', 'D811', 'R10', 'D394', 'R9', 'U227', 'L848', 'U420', 'L378', 'D622', 'L501', 'U397', 'R855', 'U369', 'R615', 'U591', 'L674', 'D166', 'L181', 'U61', 'L224', 'U463', 'L203', 'U594', 'R93', 'U614', 'L959', 'U198', 'L689', 'D229', 'L674', 'U255', 'R843', 'D382', 'R538', 'U923', 'L960', 'D775', 'L879', 'U97', 'R137', 'U665', 'L340', 'D941', 'L775', 'D57', 'R852', 'D167', 'R980', 'U704', 'L843', 'U989', 'L611', 'D32', 'L724', 'D790', 'L32', 'U984', 'L39', 'U671', 'L994', 'U399', 'R475', 'D85', 'L322', 'D936', 'R117', 'D261', 'R705', 'D696', 'L523', 'D433', 'L239', 'U477', 'L247', 'D465', 'R560', 'D902', 'L589', 'U682', 'R645', 'U376', 'L989', 'D121', 'L215', 'U514', 'R519', 'U407', 'L218', 'D444', 'R704', 'D436', 'L680', 'U759', 'R937', 'U400', 'R533', 'D860', 'R782', 'D233', 'R840', 'D549', 'L508', 'U380', 'L992', 'U406', 'L213', 'D403', 'L413', 'D532', 'L429', 'U186', 'R262', 'U313', 'L913', 'U873', 'L838', 'D882', 'R851', 'U70', 'R185', 'D131', 'R945', 'D595', 'L330', 'U446', 'R88', 'D243', 'L561', 'D952', 'R982', 'D395', 'L708', 'U459', 'L82', 'D885', 'L996', 'U955', 'L406', 'U697', 'L183', 'U266', 'L878', 'D839', 'R843', 'D891', 'R118', 'U772', 'R590', 'D376', 'L500', 'U370', 'R607', 'D12', 'L310', 'D436', 'L602', 'D365', 'R886', 'U239', 'L471', 'D418', 'L122', 'U18', 'R879', 'D693', 'R856', 'U848', 'L657', 'D911', 'L63', 'U431', 'R41', 'U752', 'R919', 'U323', 'L61', 'D263', 'L370', 'D85', 'R929', 'D213', 'R350', 'U818', 'R458', 'D912', 'R509', 'U394', 'L734', 'U49', 'R810', 'D87', 'L870', 'U658', 'R499', 'U550', 'L402', 'U244', 'L112', 'U859', 'R836', 'U951', 'R222', 'D944', 'L691', 'D731', 'R742', 'D52', 'R984', 'D453', 'L514', 'U692', 'R812', 'U35', 'L844', 'D177', 'L110', 'D22', 'R61', 'U253', 'R618', 'D51', 'R163', 'U835', 'R704', 'U148', 'R766', 'U297', 'R457', 'D170', 'L104', 'D441', 'R330', 'D330', 'R989', 'D538', 'R668', 'D811', 'R62', 'D67', 'L470', 'D526', 'R788', 'U376', 'R708', 'U3', 'R961']
#pathTwo = ['L1009', 'D381', 'R970', 'U429', 'L230', 'D909', 'R516', 'D957', 'R981', 'U609', 'L480', 'D139', 'L861', 'U168', 'L48', 'U620', 'R531', 'D466', 'L726', 'D380', 'R977', 'D454', 'L318', 'D397', 'R994', 'U402', 'L77', 'U93', 'L359', 'D72', 'R968', 'D956', 'L174', 'D22', 'R218', 'U619', 'R593', 'U32', 'L154', 'U55', 'L169', 'U415', 'L171', 'U666', 'R617', 'U109', 'L265', 'U773', 'R541', 'D808', 'L797', 'U478', 'R731', 'U379', 'R311', 'D137', 'L806', 'U298', 'R362', 'D458', 'L254', 'D539', 'R700', 'U853', 'R246', 'D588', 'L28', 'U203', 'L432', 'U946', 'R663', 'D408', 'R974', 'U59', 'L683', 'D36', 'L139', 'U738', 'L780', 'U414', 'L401', 'D93', 'R212', 'D973', 'L710', 'U892', 'L357', 'D177', 'R823', 'D4', 'R46', 'D924', 'L235', 'D898', 'R67', 'U220', 'L592', 'U87', 'R94', 'U584', 'R979', 'D843', 'L299', 'D648', 'L491', 'U360', 'R824', 'D245', 'L944', 'D24', 'R616', 'U975', 'L4', 'U42', 'L984', 'U181', 'R902', 'D835', 'L687', 'D413', 'L767', 'U632', 'L754', 'U270', 'R413', 'U51', 'L825', 'D377', 'L596', 'U960', 'L378', 'U706', 'L859', 'D708', 'L156', 'D991', 'L814', 'U351', 'R923', 'D749', 'L16', 'D651', 'R20', 'D86', 'R801', 'U811', 'L228', 'U161', 'L871', 'U129', 'R215', 'U235', 'L784', 'U896', 'R94', 'U145', 'R822', 'U494', 'R248', 'D98', 'R494', 'U156', 'L495', 'U311', 'R66', 'D873', 'L294', 'D620', 'L885', 'U395', 'R778', 'D227', 'R966', 'U756', 'L694', 'D707', 'R983', 'D950', 'R706', 'D730', 'R415', 'U886', 'L465', 'D622', 'L13', 'D938', 'R324', 'D464', 'R723', 'U804', 'R942', 'D635', 'L729', 'D317', 'L522', 'U469', 'R550', 'D141', 'R302', 'U999', 'L642', 'U509', 'R431', 'D380', 'R18', 'D676', 'R449', 'D759', 'L495', 'U901', 'R1', 'D745', 'L655', 'U449', 'L439', 'D818', 'R55', 'D541', 'R420', 'U764', 'L426', 'D176', 'L520', 'U3', 'L663', 'D221', 'L80', 'D449', 'L987', 'U349', 'L71', 'U632', 'L887', 'D231', 'R655', 'D208', 'R698', 'D639', 'R804', 'U616', 'R532', 'U846', 'R363', 'D141', 'R659', 'U470', 'L798', 'U144', 'L675', 'U483', 'L944', 'U380', 'L329', 'U72', 'L894', 'D130', 'R53', 'U109', 'R610', 'U770', 'R778', 'U493', 'R972', 'D340', 'L866', 'U980', 'L305', 'D812', 'R130', 'D954', 'R253', 'D33', 'L912', 'U950', 'L438', 'D680', 'R891', 'U725', 'R171', 'D587', 'R549', 'D367', 'L4', 'U313', 'R522', 'D128', 'L711', 'D405', 'L769', 'D496', 'L527', 'U373', 'R725', 'D261', 'L268', 'D939', 'L902', 'D58', 'L858', 'D190', 'L442']
#pathOne = ['R1000', 'D722', 'L887', 'D371', 'R430', 'D952', 'R168', 'D541', 'L972', 'D594', 'R377', 'U890', 'R544', 'U505', 'L629', 'U839', 'L680', 'D863', 'L315', 'D10', 'L482', 'U874', 'L291', 'U100', 'R770', 'D717', 'L749', 'U776', 'L869', 'D155', 'R250', 'U672', 'L195', 'D991', 'L556', 'D925', 'R358', 'U296', 'R647', 'D652', 'L790', 'D780', 'L865', 'U405', 'L400', 'D160', 'L460', 'U50', 'R515', 'D666', 'R306', 'U746', 'R754', 'U854', 'L332', 'U254', 'R673', 'U795', 'R560', 'U69', 'L507', 'U332', 'L328', 'U547', 'L717', 'U291', 'R626', 'U868', 'L583', 'D256', 'R371', 'U462', 'R793', 'U559', 'L571', 'U270', 'R738', 'U425', 'L231', 'U549', 'L465', 'U21', 'L647', 'U43', 'R847', 'U104', 'L699', 'U378', 'L549', 'D975', 'R13', 'D306', 'R532', 'D730', 'L566', 'U846', 'L903', 'D224', 'R448', 'D424', 'L727', 'D199', 'L626', 'D872', 'L541', 'D786', 'L304', 'U462', 'R347', 'U379', 'R29', 'D556', 'L775', 'D768', 'L284', 'D480', 'R654', 'D659', 'R818', 'D57', 'L77', 'U140', 'R619', 'D148', 'R686', 'D461', 'L910', 'U244', 'R115', 'D769', 'R968', 'U802', 'L737', 'U868', 'R399', 'D150', 'L791', 'U579', 'L856', 'D11', 'R115', 'U522', 'L443', 'D575', 'L133', 'U750', 'R437', 'U718', 'L79', 'D119', 'L97', 'U471', 'R817', 'U438', 'R157', 'U105', 'L219', 'U777', 'L965', 'U687', 'L906', 'D744', 'L983', 'D350', 'R664', 'D917', 'R431', 'D721', 'L153', 'U757', 'L665', 'U526', 'L49', 'U166', 'L59', 'D293', 'R962', 'D764', 'R538', 'U519', 'L24', 'U91', 'R11', 'U574', 'L647', 'U891', 'R44', 'D897', 'L715', 'U498', 'L624', 'D573', 'R287', 'U762', 'L613', 'D79', 'R122', 'U148', 'L849', 'D385', 'R792', 'D20', 'L512', 'D431', 'R818', 'U428', 'L10', 'D800', 'R773', 'D936', 'L594', 'D38', 'R824', 'D216', 'L220', 'U358', 'L463', 'U550', 'R968', 'D346', 'L658', 'U113', 'R813', 'U411', 'L730', 'D84', 'R479', 'U877', 'L730', 'D961', 'L839', 'D792', 'R424', 'U321', 'L105', 'D862', 'L815', 'D243', 'L521', 'D913', 'L1', 'D513', 'L269', 'U495', 'L27', 'U16', 'R904', 'D926', 'R640', 'U948', 'R346', 'D240', 'L273', 'U131', 'L296', 'U556', 'R347', 'D640', 'L261', 'D43', 'R136', 'U824', 'R126', 'U583', 'R736', 'U530', 'L734', 'U717', 'L256', 'U362', 'L86', 'U48', 'R851', 'U519', 'L610', 'D134', 'L554', 'D766', 'L179', 'U637', 'R71', 'D895', 'L21', 'D908', 'R486', 'D863', 'R31', 'U85', 'R420', 'D718', 'R466', 'D861', 'R655', 'D304', 'L701', 'D403', 'L860', 'D208', 'L595', 'U64', 'R999']
#pathTwo = ['L992', 'D463', 'R10', 'D791', 'R312', 'D146', 'R865', 'D244', 'L364', 'D189', 'R35', 'U328', 'R857', 'D683', 'L660', 'D707', 'L908', 'D277', 'R356', 'U369', 'R197', 'D35', 'R625', 'D862', 'L769', 'U705', 'L728', 'U999', 'R938', 'U233', 'L595', 'U266', 'L697', 'U966', 'L536', 'D543', 'L669', 'D829', 'R910', 'U693', 'R753', 'D389', 'L647', 'U603', 'L660', 'D787', 'L138', 'D119', 'L131', 'D266', 'R268', 'D917', 'R776', 'U290', 'R920', 'U904', 'L46', 'D139', 'L341', 'D19', 'R982', 'U790', 'L981', 'U791', 'L147', 'U30', 'L246', 'U677', 'R343', 'D492', 'R398', 'D234', 'R76', 'D423', 'L709', 'D392', 'R741', 'U408', 'R878', 'U29', 'R446', 'U36', 'R806', 'U78', 'L76', 'D813', 'R584', 'U682', 'L187', 'U666', 'L340', 'D301', 'L694', 'U15', 'R800', 'U276', 'L755', 'U558', 'R366', 'D309', 'R571', 'U976', 'L286', 'D833', 'R318', 'U365', 'L864', 'U408', 'L352', 'D61', 'R284', 'D272', 'R240', 'D845', 'L206', 'U721', 'R367', 'D541', 'R628', 'U581', 'L750', 'D680', 'R695', 'D30', 'R849', 'U743', 'L214', 'U605', 'R533', 'U493', 'R803', 'D783', 'R168', 'U877', 'L61', 'D726', 'L794', 'D116', 'R717', 'U44', 'R964', 'U674', 'L291', 'D372', 'L381', 'D523', 'L644', 'U438', 'R983', 'D390', 'R520', 'D471', 'R556', 'D693', 'L919', 'D863', 'R84', 'D629', 'L264', 'D429', 'R82', 'U64', 'R835', 'D801', 'R93', 'U770', 'R441', 'D152', 'L718', 'D788', 'L797', 'U699', 'L82', 'U206', 'L40', 'U952', 'R902', 'U570', 'L759', 'D655', 'L131', 'D901', 'L470', 'D804', 'L407', 'U458', 'L922', 'D21', 'L171', 'U841', 'L237', 'D301', 'R192', 'D293', 'R984', 'U243', 'R846', 'U139', 'L413', 'U162', 'R925', 'D235', 'L115', 'U443', 'L884', 'D910', 'R335', 'U274', 'L338', 'U160', 'R125', 'D775', 'R824', 'D821', 'R531', 'D761', 'L189', 'U822', 'L602', 'D732', 'R473', 'U149', 'L128', 'U30', 'R77', 'D957', 'R811', 'D154', 'L988', 'D237', 'R425', 'D855', 'R482', 'D571', 'R134', 'D731', 'L905', 'U869', 'R916', 'D689', 'L17', 'U24', 'R353', 'D996', 'R832', 'U855', 'L76', 'U659', 'R581', 'D483', 'R821', 'D145', 'R199', 'D344', 'R487', 'D436', 'L92', 'U491', 'R365', 'D909', 'L17', 'D148', 'R307', 'U57', 'R666', 'U660', 'R195', 'D767', 'R612', 'D902', 'L594', 'D299', 'R670', 'D881', 'L583', 'D793', 'R58', 'U89', 'L99', 'D355', 'R394', 'D350', 'R920', 'U544', 'R887', 'U564', 'L238', 'U979', 'L565', 'D914', 'L95', 'U150', 'R292', 'U495', 'R506', 'U475', 'R813', 'D308', 'L797', 'D484', 'R9']
pathOne = ['R990', 'U796', 'R784', 'U604', 'R6', 'U437', 'L96', 'U285', 'L361', 'U285', 'L339', 'D512', 'L389', 'D840', 'L425', 'U444', 'L485', 'D528', 'L262', 'U178', 'L80', 'U2', 'R952', 'U459', 'L361', 'D985', 'R56', 'U135', 'R953', 'D913', 'L361', 'U120', 'L329', 'U965', 'L294', 'U890', 'L126', 'U214', 'R232', 'D444', 'L714', 'U791', 'R888', 'U923', 'R378', 'U233', 'L654', 'D703', 'R902', 'D715', 'R469', 'D60', 'R990', 'U238', 'R755', 'U413', 'L409', 'D601', 'R452', 'U504', 'R472', 'D874', 'L766', 'D594', 'R696', 'U398', 'R593', 'D889', 'R609', 'D405', 'L962', 'U176', 'L237', 'U642', 'L393', 'D91', 'L463', 'U936', 'R199', 'D136', 'R601', 'D8', 'R359', 'D863', 'L410', 'U598', 'L444', 'D34', 'R664', 'D323', 'R72', 'D98', 'L565', 'D476', 'L197', 'D132', 'R510', 'U665', 'R936', 'U3', 'R385', 'U144', 'L284', 'D713', 'L605', 'U106', 'R543', 'D112', 'R528', 'D117', 'R762', 'U330', 'R722', 'U459', 'L229', 'U375', 'L870', 'D81', 'R623', 'U95', 'L148', 'D530', 'L622', 'D62', 'R644', 'D365', 'L214', 'U847', 'R31', 'D832', 'L648', 'D293', 'R79', 'D748', 'L270', 'U159', 'L8', 'U83', 'R195', 'U912', 'L409', 'D649', 'L750', 'D286', 'L623', 'D956', 'R81', 'U775', 'R44', 'D437', 'L199', 'U698', 'L42', 'U419', 'L883', 'U636', 'L323', 'U89', 'L246', 'D269', 'L992', 'U739', 'R62', 'U47', 'R63', 'U17', 'L234', 'U135', 'R126', 'D208', 'L69', 'U550', 'L123', 'D66', 'R463', 'U992', 'R411', 'D276', 'L851', 'U520', 'R805', 'D300', 'L894', 'U171', 'L922', 'D901', 'R637', 'U907', 'R328', 'U433', 'L316', 'D644', 'L398', 'U10', 'L648', 'D190', 'R884', 'U474', 'R397', 'D718', 'L925', 'D578', 'R249', 'U959', 'L697', 'D836', 'R231', 'U806', 'R982', 'U827', 'R579', 'U830', 'L135', 'D666', 'R818', 'D502', 'L898', 'D585', 'R91', 'D190', 'L255', 'U535', 'R56', 'U390', 'R619', 'D815', 'L300', 'D81', 'R432', 'D70', 'L940', 'D587', 'L259', 'D196', 'R241', 'U4', 'R440', 'U678', 'R185', 'U451', 'R733', 'D984', 'R464', 'D298', 'L738', 'U600', 'R353', 'D44', 'L458', 'U559', 'L726', 'D786', 'L307', 'D333', 'L226', 'D463', 'R138', 'D142', 'L521', 'D201', 'R51', 'D202', 'L204', 'U130', 'L333', 'U597', 'R298', 'U42', 'L951', 'U66', 'R312', 'U707', 'L555', 'D225', 'L360', 'D12', 'L956', 'D361', 'L989', 'D625', 'L944', 'D398', 'L171', 'D982', 'L377', 'U114', 'L339', 'U164', 'R39', 'D793', 'R992', 'U834', 'R675', 'U958', 'R334', 'D697', 'L734', 'D40', 'L149', 'U394', 'R976']
pathTwo = ['L1005', 'D52', 'L125', 'U787', 'L761', 'U262', 'L466', 'D966', 'R895', 'U789', 'R6', 'U2', 'R870', 'U971', 'R238', 'D946', 'L752', 'D240', 'R721', 'U349', 'L679', 'D518', 'L104', 'U417', 'L462', 'U544', 'L519', 'U797', 'R873', 'U70', 'R298', 'U45', 'L779', 'D921', 'R468', 'D421', 'R803', 'U108', 'L812', 'D498', 'R226', 'D309', 'R766', 'U724', 'L961', 'U472', 'R940', 'U944', 'R418', 'D682', 'R328', 'U55', 'R737', 'U961', 'L343', 'U397', 'R112', 'D292', 'L155', 'U162', 'R398', 'U445', 'L524', 'U256', 'R323', 'D587', 'L862', 'D726', 'R624', 'D230', 'R460', 'U539', 'R723', 'U93', 'L507', 'U608', 'L150', 'U159', 'R35', 'U458', 'R208', 'U546', 'L495', 'D835', 'L636', 'U960', 'L322', 'U408', 'L78', 'D250', 'L994', 'U818', 'R107', 'U978', 'R401', 'D147', 'R574', 'D549', 'R983', 'U698', 'L99', 'D63', 'L772', 'U409', 'R975', 'U990', 'L893', 'U467', 'L860', 'D721', 'R504', 'U102', 'R678', 'D672', 'L406', 'D933', 'R743', 'D788', 'R142', 'D44', 'R208', 'D424', 'R28', 'D674', 'R331', 'D968', 'L154', 'U206', 'R222', 'D354', 'R687', 'D331', 'L539', 'D390', 'L373', 'D514', 'L622', 'U673', 'R345', 'U943', 'L508', 'D337', 'R265', 'D785', 'L189', 'U429', 'R344', 'D719', 'R622', 'U199', 'L765', 'U350', 'R833', 'U309', 'R95', 'U911', 'R548', 'U746', 'R107', 'D867', 'L648', 'D680', 'R28', 'U596', 'L891', 'U168', 'R933', 'U571', 'R365', 'U267', 'R916', 'D130', 'L149', 'D898', 'L513', 'D167', 'R587', 'U799', 'R134', 'D328', 'R562', 'D929', 'L399', 'U568', 'R565', 'U241', 'L395', 'U822', 'L624', 'D145', 'L995', 'U516', 'R474', 'D609', 'R153', 'U52', 'R561', 'D15', 'R283', 'U321', 'L850', 'U218', 'L225', 'D635', 'L630', 'U102', 'L84', 'D672', 'L128', 'D885', 'L506', 'U911', 'R355', 'D132', 'R155', 'D120', 'L110', 'U368', 'R149', 'D343', 'L708', 'U378', 'R591', 'D585', 'L381', 'D517', 'R852', 'U432', 'R342', 'U273', 'R893', 'D277', 'L548', 'U859', 'L891', 'U311', 'L901', 'U255', 'R421', 'U90', 'L72', 'D474', 'L654', 'U12', 'L146', 'D867', 'L485', 'D663', 'R123', 'D82', 'L21', 'U408', 'L38', 'D864', 'L114', 'D645', 'R936', 'U765', 'L832', 'D668', 'L482', 'U79', 'L594', 'U276', 'L559', 'D469', 'R314', 'D162', 'R621', 'U230', 'L688', 'U82', 'R605', 'U191', 'L381', 'D327', 'L91', 'D217', 'R714', 'D942', 'R851', 'U358', 'R22', 'U952', 'R279', 'D897', 'R485', 'D867', 'L940', 'U891', 'L223', 'D264', 'L634', 'D560', 'R645', 'D705', 'L289', 'U584', 'R97', 'U920', 'R41']

origin = [0,0]

# Returns an array with all points on the path
# pathNum is the integer representation of the path (i.e. pathOne is 1)
def CreatePath(path, o):
    # initialize curHead to origin
    curHead = [0,0]
    curHead[0] = o[0]
    curHead[1] = o[1]
    p = []
    for point in path:
        if(point[0] == 'R'):
            for x in range(int(point[1:])):
                curHead[0] += 1
                p.append((curHead[0], curHead[1]))
        if(point[0] == 'L'):
            for x in range(int(point[1:]), 0, -1):
                curHead[0] -= 1
                p.append((curHead[0], curHead[1]))
        if(point[0] == 'U'):
            for y in range(int(point[1:])):
                curHead[1] += 1
                p.append((curHead[0], curHead[1]))
        if(point[0] == 'D'):
            for y in range(int(point[1:]), 0, -1):
                curHead[1] -= 1
                p.append((curHead[0], curHead[1]))
    return p

# Creates a hash table to be used to find intersection Points
# It will add all points on path one (assign '1') and check path two against that
# For points that are found to be interections, the value in the map will be 'X'
def IntersectionHashTable(p1, p2):
    # Hash table, '1' is unique point, '2' is interesection point
    hash_table = {}
    # Add p1 points to the hash table
    for p in p1:
        hash_table[p] = '1'
    for p in p2:
        if p in hash_table:
            if hash_table[p] == '1':
                hash_table[p] = 'X'
        else:
            hash_table[p] = '2'

    return hash_table

def FindIntersectionPoints(hash_table):
    intersectionPoints = []
    for k,v in hashTable.items():
        if v == 'X':
            intersectionPoints.append(k)
    return intersectionPoints

# Requires the grid as an argument
def ManhattenDistance(intersect_points):
    # Don't have a grid over 4 million in any direction
    stopDebug = False
    min_dist = 4000000
    # Find the points of intersection
    for point in intersect_points:
        min_dist = min(min_dist, abs(point[0]) + abs(point[1]))
    return min_dist

# Create the paths
print('[*] Computing Path One')
firstPath = CreatePath(pathOne, origin)
if DEBUG:
    print("##### Path One #####")
    print(firstPath)
print()
print('[*] Computing Path Two')
secondPath = CreatePath(pathTwo, origin)
if DEBUG:
    print('##### Path Two #####')
    print(secondPath)
print()

print("[*] Creating Hash Table...")
hashTable = IntersectionHashTable(firstPath, secondPath)
if DEBUG:
    print("##### Hash Table of Points #####")
    print(hashTable)
    print()
print("[*] Finding Intersection points")
intersectionPoints = FindIntersectionPoints(hashTable)
if DEBUG:
    print("##### Intersection Points #####")
    print(intersectionPoints)
    print()
print('[*] Computing Manhatten Distance')
print("##### ManhattenDistance #####")
print(ManhattenDistance(intersectionPoints))
